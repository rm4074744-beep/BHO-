<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Premium Story Editor - Instagram Style Music</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body { margin: 0; background: #000; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; height: 100vh; }

  .editor-container { position: relative; width: 100%; height: 100vh; }
  
  /* সাইড মেনু */
  .side-tools {
    position: absolute; right: 15px; top: 60px; z-index: 50;
    display: flex; flex-direction: column; gap: 15px;
  }
  .icon-bg {
    width: 44px; height: 44px; background: rgba(255,255,255,0.15);
    backdrop-filter: blur(15px); border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    border: 1px solid rgba(255,255,255,0.2); cursor: pointer;
  }

  /* মিউজিক লাইব্রেরি প্যানেল (Instagram Style) */
  #audio-panel {
    position: absolute; bottom: -100%; left: 0; width: 100%; height: 80vh;
    background: #1a1a1a; border-radius: 20px 20px 0 0;
    z-index: 200; transition: bottom 0.4s ease;
    display: flex; flex-direction: column;
  }
  #audio-panel.active { bottom: 0; }

  .audio-header {
    padding: 20px; text-align: center; border-bottom: 1px solid #333;
    display: flex; justify-content: space-between; align-items: center;
  }
  .search-bar {
    background: #333; border-radius: 10px; padding: 10px; margin: 15px;
    display: flex; align-items: center; gap: 10px; color: #888;
  }

  .audio-list { flex: 1; overflow-y: auto; padding: 0 15px 100px; }
  
  .audio-item {
    display: flex; align-items: center; gap: 15px; padding: 12px 0;
    border-bottom: 1px solid #222; cursor: pointer;
  }
  .audio-thumb {
    width: 50px; height: 50px; border-radius: 5px; background: #333;
    display: flex; justify-content: center; align-items: center;
  }
  .audio-info { flex: 1; }
  .audio-info h4 { margin: 0; font-size: 15px; color: #fff; }
  .audio-info p { margin: 3px 0 0; font-size: 12px; color: #888; }

  /* ইফেক্ট প্যানেল (আগের মতই) */
  #effect-panel {
    position: absolute; bottom: -250px; width: 100%; z-index: 100;
    transition: bottom 0.4s; background: rgba(0,0,0,0.8); backdrop-filter: blur(15px);
  }
  #effect-panel.active { bottom: 110px; }
  .effect-scroll { display: flex; gap: 15px; overflow-x: auto; padding: 15px 20px; scrollbar-width: none; }

  .footer { 
    position: absolute; bottom: 30px; width: 100%; 
    padding: 0 20px; display: flex; justify-content: space-between; z-index: 50;
  }
  .share-now {
    background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
    color: white; border: none; padding: 12px 28px; border-radius: 50px; font-weight: bold;
  }
</style>
</head>
<body>

<div class="editor-container">
  <canvas id="mainCanvas"></canvas>

  <div class="side-tools">
    <div onclick="addText()"><div class="icon-bg"><span class="material-icons">title</span></div></div>
    <div onclick="openEffects()"><div class="icon-bg"><span class="material-icons">auto_fix_high</span></div></div>
    <div onclick="openAudio()"><div class="icon-bg"><span class="material-icons">music_note</span></div></div>
  </div>

  <div id="audio-panel">
    <div class="audio-header">
      <span style="font-weight: bold;">Music</span>
      <span class="material-icons" onclick="closeAudio()">expand_more</span>
    </div>
    <div class="search-bar">
      <span class="material-icons">search</span>
      <span>Search music...</span>
    </div>
    <div class="audio-list" id="audioContainer">
      </div>
  </div>
   
  <div id="effect-panel">
    <div class="done-bar" style="text-align:center; padding:10px;"><button onclick="closeEffects()" style="border-radius:20px; padding:5px 20px;">Done</button></div>
    <div class="effect-scroll" id="effectContainer"></div>
  </div>

  <div class="footer" id="mainFooter">
    <div class="icon-bg"><span class="material-icons">settings</span></div>
    <button class="share-now">Share now <span class="material-icons">send</span></button>
  </div>
</div>

<script>
  const canvas = new fabric.Canvas('mainCanvas', { width: window.innerWidth, height: window.innerHeight, selection: false });

  // ৫০টি গানের লিস্ট সাজানোর জন্য অ্যারে
  const myAudios = [
    { title: "My Nasheed", artist: "Gemini", url: "https://archive.org/download/gemini_generated_video_f360149b/gemini_generated_video_f360149b.mp3", img: "https://via.placeholder.com/50" },
    { title: "Peaceful Mind", artist: "Nature", url: "#", img: "https://via.placeholder.com/50" },
    { title: "Soft Rain", artist: "Ambience", url: "#", img: "https://via.placeholder.com/50" },
    // এভাবে ৫০টি গান যোগ করুন...
  ];

  let currentAudio = new Audio();

  window.onload = () => {
    generateEffects();
    generateAudioLibrary();
  };

  function generateAudioLibrary() {
    const container = document.getElementById('audioContainer');
    myAudios.forEach(audio => {
      const item = document.createElement('div');
      item.className = 'audio-item';
      item.innerHTML = `
        <div class="audio-thumb"><span class="material-icons">play_arrow</span></div>
        <div class="audio-info">
          <h4>${audio.title}</h4>
          <p>${audio.artist}</p>
        </div>
        <span class="material-icons" style="color:#888;">bookmark_border</span>
      `;
      item.onclick = () => playAudio(audio.url);
      container.appendChild(item);
    });
  }

  function playAudio(url) {
    if(url === "#") return alert("লিঙ্ক যোগ করা হয়নি!");
    currentAudio.src = url;
    currentAudio.play();
    closeAudio();
  }

  function openAudio() { document.getElementById('audio-panel').classList.add('active'); }
  function closeAudio() { document.getElementById('audio-panel').classList.remove('active'); }

  // ইফেক্টস ফাংশনসমূহ (আগের মতই থাকবে)
  function openEffects() { document.getElementById('effect-panel').classList.add('active'); }
  function closeEffects() { document.getElementById('effect-panel').classList.remove('active'); }
  
  function generateEffects() {
    // আগের generateEffects কোডটি এখানে বসিয়ে দিন
  }

  function addText() {
    const text = new fabric.IText('টাইপ করুন', { left: canvas.width/2, top: canvas.height/2, fill: '#fff', originX: 'center' });
    canvas.add(text);
    canvas.setActiveObject(text);
  }
</script>

</body>
</html>
